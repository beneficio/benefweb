<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" language="javascript">
function validarCBU(cbu) {
   var VEC1 = new Array(7, 1, 3, 9, 7, 1, 3);
   var VEC2 = new Array(3, 9, 7, 1, 3, 9, 7, 1, 3, 9, 7, 1, 3);
   var valido = false;
   bloque1 = cbu.substring(0, 7);
   digitoValidador1 = cbu.substring(7, 8);
   bloque2 = cbu.substring(8, 21);
   digitoValidador2 = cbu.substring(21);

   var acum = 0;

   for (i = 0; i < 7; i++) {
      acum += bloque1.substring(i, i + 1) * VEC1[i];
   }

   strAcum = (acum + '');
   var digitoVCalculado1 = 10 - strAcum.substring(strAcum.length - 1);
   valido = (digitoVCalculado1 == digitoValidador1);

   acum = 0;
   for (i = 0; i < 13; i++) {
      acum += bloque2.substring(i, i + 1) * VEC2[i];
   }

   strAcum = (acum + '');
   var digitoVCalculado2 = 10 - strAcum.substring(strAcum.length - 1);

   valido = (digitoVCalculado2 == digitoValidador2) && valido;
   return valido;
}

function validar (cbu) {
    if (validarCBU(cbu)) {
        alert ("CBU valida");
    }  else {
        alert ("CBU erronea");
    }
}
    </script>
  </head>
  <body>
      <input type="text" size="22" maxlength="22" name="cbu" id="cbu" >
      <input type="submit" onclick="javascript:validar( document.getElementById('cbu').value );">

<a href="http://qr.afip.gob.ar/?qr=-tPe_XC8VxJ93E9_QR6GMQ,," target="_F960AFIPInfo"><img src="http://www.afip.gob.ar/images/f960/DATAWEB.jpg" border="0"></a>


  </body>
</html>
